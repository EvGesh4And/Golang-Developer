
## 4.8 Стандарты для интерфейсов командной строки

Рекомендуется следовать рекомендациям POSIX для параметров командной строки программы. Самый простой способ сделать это — использовать `getopt` для их обработки. Обратите внимание, что версия GNU `getopt` обычно позволяет параметры находиться в любом месте среди аргументов, если не использовать специальный аргумент `--`. Это не соответствует стандартам POSIX; это является расширением GNU.

Рекомендуется определять длинные параметры командной строки, которые эквивалентны однобуквенным опциям в стиле Unix. Это легко сделать с помощью функции GNU `getopt_long`.

Одним из преимуществ длинных опций является то, что они могут быть одинаковыми во всех программах. Например, пользователи должны ожидать, что опция "verbose" в любой GNU программе будет всегда записана как `--verbose`. Для обеспечения такой унификации следует использовать таблицу общих длинных опций при выборе имен опций для вашей программы (см. [таблицу опций](https://www.gnu.org/prep/standards/standards.html#Option-Table)).

Обычно файлы, указанные как обычные аргументы, должны быть только входными файлами; любые выходные файлы должны указываться через опции (предпочтительно с использованием `-o` или `--output`). Даже если вы допускаете указание имени выходного файла как обычного аргумента для совместимости, старайтесь предоставить опцию как другой способ его указания. Это приведет к большему согласованию среди утилит GNU и уменьшит количество мелких особенностей, которые пользователи должны запомнить.

Все программы должны поддерживать две стандартные опции: `--version` и `--help`. CGI программы должны принимать их как параметры командной строки, а также если они указаны в PATH_INFO; например, при переходе по адресу `http://example.org/p.cgi/--help` в браузере должна выводиться та же информация, что и при запуске `p.cgi --help` из командной строки.

- `--version`: Выводит информацию о версии программы.
- `--help`: Выводит справочную информацию о программе.

### 4.8.1 `--version`

Стандартная опция `--version` должна заставить программу вывести информацию о ее названии, версии, происхождении и правовом статусе на стандартный вывод, а затем завершиться с успешным кодом возврата. Все другие опции и аргументы должны быть проигнорированы, как только эта опция будет обнаружена, и программа не должна выполнять свою обычную функцию.

Первая строка должна быть легко обрабатываемой программой; номер версии начинается после последнего пробела. Также она должна содержать каноническое имя программы в следующем формате:

```
GNU Emacs 19.30
```

Имя программы должно быть постоянной строкой; не вычисляйте его из `argv[0]`. Идея заключается в том, чтобы указать стандартное или каноническое имя программы, а не ее имя файла. Существуют другие способы выяснить точное имя файла, где команда находится в PATH.

Если программа является частью большего пакета, упомяните имя пакета в скобках, как в следующем примере:

```
emacsserver (GNU Emacs) 19.30
```

Если версия пакета отличается от версии самой программы, вы можете упомянуть версию пакета перед закрывающей скобкой.

Если вам нужно упомянуть версии библиотек, которые распространяются отдельно от пакета, который содержит эту программу, сделайте это, выведя дополнительную строку версии для каждой библиотеки, которую хотите упомянуть. Используйте тот же формат для этих строк, что и для первой.

После строк с номером версии должна следовать строка с уведомлением о праве на авторство. Если требуется несколько уведомлений о праве на авторство, каждое должно быть в отдельной строке.

Затем следует строка, указывающая лицензию, предпочтительно с использованием одного из сокращений ниже, и краткое заявление о том, что программа является свободным ПО, и что пользователи могут ее изменять и распространять. Также упомяните, что программа предоставляется без каких-либо гарантий, в пределах, разрешенных законом.

Пример вывода:

```
GNU hello 2.3
Copyright (C) 2007 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <https://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
```

Эти уведомления о праве на авторство должны упоминать только последний год, в котором были сделаны изменения. Указывать года для изменений в предыдущих версиях не нужно. Вам не нужно упоминать имя программы в этих уведомлениях, если это неудобно, так как оно уже указано в первой строке. (Правила для уведомлений о праве на авторство в исходных файлах отличаются; см. раздел "Copyright Notices in Information for GNU Maintainers").

Переводы этих строк должны сохранять юридическую ценность уведомлений о праве на авторство (см. раздел "Internationalization"). Если поддерживаемая кодировка символов позволяет, символ © должен быть использован вместо "(C)".

В конце можно добавить список основных авторов программы, чтобы выразить благодарность.

### 4.8.2 `--help`

Стандартная опция `--help` должна выводить краткую документацию по использованию программы, а затем завершиться с успешным кодом возврата. Все другие опции и аргументы должны быть проигнорированы, как только эта опция будет обнаружена, и программа не должна выполнять свою обычную функцию.

В конце вывода опции `--help` должны быть строки с адресом электронной почты для сообщений о багах, домашней страницей пакета (обычно это `https://www.gnu.org/software/pkg`) и общей страницей для помощи по использованию программ GNU. Формат должен быть следующим:

```
Report bugs to: mailing-address
pkg home page: <https://www.gnu.org/software/pkg/>
General help using GNU software: <https://www.gnu.org/gethelp/>
```

Также можно упомянуть другие соответствующие почтовые списки и веб-страницы.
