# gRPC (—Ç–µ–æ—Ä–∏—è)

## –û —á–µ–º –±—É–¥–µ–º –≥–æ–≤–æ—Ä–∏—Ç—å

- –ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ Protobuf
- –ß—Ç–æ —Ç–∞–∫–æ–µ gRPC

## –ü–ª–∞–Ω –∑–∞–Ω—è—Ç–∏—è

- –ó–Ω–∞–∫–æ–º–∏–º—Å—è —Å Protocol buffers
- –ü—Ä—è–º–∞—è –∏ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤ Protocol buffers
- –û–ø–∏—Å–∞–Ω–∏–µ API —Å –ø–æ–º–æ—â—å—é Protobuf
- –ß—Ç–æ —Ç–∞–∫–æ–µ gRPC –∏ HTTP/2

## Protobuf

```proto
syntax = "proto3";              // –£–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ—Ä—Å–∏—è proto3

message SearchRequest {
  string query = 1;             // –¢–µ–∫—Å—Ç –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
  int32 page_number = 2;        // –ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏)
  int32 results_per_page = 3;   // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
}
```

**–ö—Ä–∞—Ç–∫–∏–µ –ø–æ—è—Å–Ω–µ–Ω–∏—è:**

- `message SearchRequest` ‚Äî –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∏–º–µ–Ω–µ–º `SearchRequest`.

- `string` –∏ `int32` ‚Äî —Ç–∏–ø—ã –ø–æ–ª–µ–π (—Å—Ç—Ä–æ–∫–∞ –∏ 32-–±–∏—Ç–Ω–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ).

- `= 1`, `= 2`, `= 3` ‚Äî —Ç–µ–≥–∏ –ø–æ–ª–µ–π. –û–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –∏–∑–º–µ–Ω—è—Ç—å—Å—è –ø–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å—Ö–µ–º—ã, —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å.

–≠—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –ø–æ–∏—Å–∫ –≤ API, –≥–¥–µ –∫–ª–∏–µ–Ω—Ç —É–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–∏—Å–∫–æ–≤—É—é —Å—Ç—Ä–æ–∫—É –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞–≥–∏–Ω–∞—Ü–∏–∏.


### Protobuf: tags

- –ù–æ–º–µ—Ä–∞ —Ç–µ–≥–æ–≤ —É–Ω–∏–∫–∞–ª—å–Ω—ã –≤ —Ä–∞–º–∫–∞—Ö —Å–æ–æ–±—â–µ–Ω–∏—è
- –ù–æ–º–µ—Ä–∞ –æ—Ç 1 –¥–æ 536.870.911
- –ù–æ–º–µ—Ä–∞ –æ—Ç 19.000 –¥–æ 19.999 –∑–∞—Ä–∞–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω—ã –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–º
- –¢–µ–≥–∏ —Å 1 –¥–æ 15 –∑–∞–Ω–∏–º–∞—é—Ç 1 –±–∞–π—Ç


–í **protobuf** **—Ç–µ–≥–∏** (–ø–æ—Ä—è–¥–∫–æ–≤—ã–µ –Ω–æ–º–µ—Ä–∞ –ø–æ–ª–µ–π) **–≤—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å 1, –∞ –Ω–µ —Å 0**.

–í–æ—Ç –ø–æ—á–µ–º—É:

**üî¢ –ü–æ—á–µ–º—É —Ç–µ–≥–∏ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å 1**

- **–¢–µ–≥ 0 –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω** –≤–Ω—É—Ç—Ä–∏ Protocol Buffers –∏ **–Ω–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è** –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø–æ–ª–µ–π.

- –≠—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–º –ø—Ä–∏—á–∏–Ω–∞–º: —Ç–µ–≥ 0 –≤ wire format –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ "–Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –ø–æ–ª–µ" –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ.

- –ü–æ—ç—Ç–æ–º—É **–≤—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–µ–º —Å 1 –∏ –¥–∞–ª–µ–µ: 1, 2, 3, ...** ‚Äî –∏ –ø—Ä–∏ —ç—Ç–æ–º –≤–∞–∂–Ω–æ –Ω–µ –º–µ–Ω—è—Ç—å –∏—Ö –ø–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å—Ö–µ–º—ã.

**üõ† –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- **–ö–∞–∂–¥–æ–µ –ø–æ–ª–µ –¥–æ–ª–∂–Ω–æ –∏–º–µ—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ç–µ–≥** –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ message.
- –ù–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å —Ç–µ–≥–æ–≤ –∫—Ä–∏—Ç–∏—á–Ω–∞: **–µ—Å–ª–∏ —Ç—ã –º–µ–Ω—è–µ—à—å –Ω–æ–º–µ—Ä —Ç–µ–≥–∞ —É —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—è**, –ø–æ–ª—É—á–∞—Ç–µ–ª—å –Ω–µ —Å–º–æ–∂–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ.
- –ï—Å–ª–∏ —Ç—ã —É–¥–∞–ª—è–µ—à—å –ø–æ–ª–µ ‚Äî –ª—É—á—à–µ –Ω–µ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ —Ç–µ–≥, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤.

### Protocol buffers: —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

https://developers.google.com/protocol-buffers/docs/encoding

**‚úÖ –°–∫–∞–ª—è—Ä–Ω—ã–µ —Ç–∏–ø—ã protobuf3**

| –¢–∏–ø          | –†–∞–∑–º–µ—Ä          | –û–ø–∏—Å–∞–Ω–∏–µ         |
| ------------ | --------------- | ---------------- |
| `float`/`double`      | 32 –±–∏—Ç/64 –±–∏—Ç   | –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç `float32`/`float64`. –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä. |
| `fixed32`/`fixed64`   | 32 –±–∏—Ç/64 –±–∏—Ç   | –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç `uint32`/`uint64`. –ë–µ–∑–∑–Ω–∞–∫–æ–≤–æ–µ —Ü–µ–ª–æ–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞. **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω, –µ—Å–ª–∏ —á–∞—Å—Ç–æ –ø–µ—Ä–µ–¥–∞—ë—à—å –±–æ–ª—å—à–∏–µ —á–∏—Å–ª–∞.** |
| `sfixed32`/`sfixed64` | 32 –±–∏—Ç/64 –±–∏—Ç   | –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç `int32`/`int64`. –ë–µ–∑–∑–Ω–∞–∫–æ–≤–æ–µ —Ü–µ–ª–æ–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞. **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω, –µ—Å–ª–∏ —á–∞—Å—Ç–æ –ø–µ—Ä–µ–¥–∞—ë—à—å –±–æ–ª—å—à–∏–µ —á–∏—Å–ª–∞.** |
| `int32`/`int64`       | varint/varint   | –¶–µ–ª–æ–µ —Å–æ –∑–Ω–∞–∫–æ–º. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –¥–ª—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö —á–∏—Å–µ–ª (0...127 = 1 –±–∞–π—Ç). –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ ‚Äî –¥–æ 10 –±–∞–π—Ç. |
| `uint32`/`uint64`   | varint/varint          | –¶–µ–ª–æ–µ –±–µ–∑ –∑–Ω–∞–∫–∞. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö —á–∏—Å–µ–ª.   |
| `sint32`/`sint64`   | varint (ZigZag)/varint (ZigZag) | –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ, —á–µ–º `int32`. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç ZigZag-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ.      |
| `bool `    | 1 –±–∞–π—Ç          | `true` –∏–ª–∏ `false`.            |
| `string`   | –¥–ª–∏–Ω–∞ + UTF-8   | –°—Ç—Ä–æ–∫–∞ –≤ –∫–æ–¥–∏—Ä–æ–≤–∫–µ UTF-8. –°–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç—Å—è –∫–∞–∫ –¥–ª–∏–Ω–∞ + –±–∞–π—Ç—ã. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Unicode.  |
| `bytes`    | –¥–ª–∏–Ω–∞ + `[]byte` | –°—ã—Ä—ã–µ –±–∞–π—Ç—ã. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–∏–Ω–∞—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.      |

**üí° –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏**

**üìè Varint**

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `int32`, `int64`, `uint32`, `uint64`, `sint32`, `sint64`.

- **–ú–∞–ª–µ–Ω—å–∫–∏–µ —á–∏—Å–ª–∞ –∑–∞–Ω–∏–º–∞—é—Ç –º–µ–Ω—å—à–µ –º–µ—Å—Ç–∞**

  - –ü—Ä–∏–º–µ—Ä: `0 ... 127` ‚Üí 1 –±–∞–π—Ç

- **–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤** `int32`/`int64` ‚Üí –≤—Å–µ–≥–¥–∞ 5/10 –±–∞–π—Ç!

  - –ü–æ—ç—Ç–æ–º—É –¥–ª—è –Ω–∏—Ö –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `sint32`/`sint64` + ZigZag

**‚ö° ZigZag (–≤ `sint32`/`sint64`)**

ZigZag-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞:

| –ó–Ω–∞—á–µ–Ω–∏–µ | ZigZag | Varint |
| -------- | ------ | ------ |
| 0        | 0      | 0x00   |
| -1       | 1      | 0x01   |
| 1        | 2      | 0x02   |
| -2       | 3      | 0x03   |


**üì¶ fixed vs varint**
- `fixed32` / `fixed64` **–≤—Å–µ–≥–¥–∞ 4 / 8 –±–∞–π—Ç**, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è.
- **–ò—Å–ø–æ–ª—å–∑—É–π –∏—Ö, –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è —á–∞—Å—Ç–æ –±–æ–ª—å—à–∏–µ**, –∏ —Ç—ã –Ω–µ —Ö–æ—á–µ—à—å —Ç—Ä–∞—Ç–∏—Ç—å –¥–æ 10 –±–∞–π—Ç –Ω–∞ varint.

### Protocol buffers: repeated fields

–°–ª–∞–π—Å —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ **repeated**:

```proto
message SearchResponse {
    repeated Result results = 1;
}
message Result {
    string url = 1;
    string title = 2;
    repeated string snippets = 3;
}
```

``` proto
...
Snippets    []string `protobuf:"bytes,3,rep,name=snippets,proto3" json:"snippets,omitempty"`
...
Results     []*Result `protobuf:"bytes,1,rep,name=results,proto3" json:"results,omitempty"`
```

### Protocol buffers: Enums

```proto
enum EyeColor {
    EYE_COLOR_UNSPECIFIED = 0;
    EYE_COLOR_GREEN = 1;
    EYE_COLOR_BLUE = 2;
}
message Person {
    string name = 1;
    EyeColor eye_color = 2;
}
```

```go
type EyeColor int32
const (
    EyeColor_UNSPECIFIED    EyeColor = 0  // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ "–Ω—É–ª–µ–≤–æ–µ" –∑–Ω–∞—á–µ–Ω–∏–µ
    EyeColor_EYE_GREEN      EyeColor = 1
    EyeColor_EYE_BLUE       EyeColor = 2
)
```

### Protocol buffers: –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

| –¢–∏–ø –ø–æ–ª—è   | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é     | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π                                               |
| ---------- | ------------------------- | --------------------------------------------------------- |
| `string`   | `""`                      | –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞                                             |
| `bool`     | `false`                   |                                                           |
| `int32`    | `0`                       | –¢–æ –∂–µ –¥–ª—è `int64`, `uint32`, `uint64`, `float`, `double`  |
| `bytes`    | `[]byte{}` (–ø—É—Å—Ç–æ–π —Å–ª–∞–π—Å) |                                                           |
| `enum`     | –ü–µ—Ä–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–Ω–æ–µ        | –í—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –Ω—É–ª—è                                  |
| `repeated` | –ü—É—Å—Ç–æ–π —Å–ª–∞–π—Å              | –ù–µ `nil`, –∞ –∏–º–µ–Ω–Ω–æ –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ (–≤ —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ) |
| `message`  | `nil` –≤ Go                | –¢–æ –µ—Å—Ç—å –ø–æ–ª–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –µ—Å–ª–∏ —è–≤–Ω–æ –Ω–µ –∑–∞–¥–∞–Ω–æ             |

[–î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è](https://developers.google.com/protocol-buffers/docs/reference/go-generated#singular-message)


### Protocol buffers: oneof, map


`oneof` - —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ –ø–æ–ª–µ –∏–∑ —Å–ø–∏—Å–∫–∞ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å **repeated**.


```proto
message Message {
    int32 id = 1;
    oneof auth {
        string mobile = 2;
        string email = 3;
        int32 userid = 4;
    }
}
```

`map` - –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–π –º–∞—Å—Å–∏–≤;
–∫–ª—é—á–∏ - —Å–∫–∞–ª—è—Ä—ã (–∫—Ä–æ–º–µ `float`/`double`);
–∑–Ω–∞—á–µ–Ω–∏—è - –ª—é–±—ã–µ —Ç–∏–ø—ã, –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å **repeated**.

```proto
message Result {
    string result = 1;
}
message SearchResponse {
    map<string, Result> results = 1;
}
```


### Protocol buffers: wire types


–í Protocol Buffers –ø—Ä–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞–∂–¥–æ–µ –ø–æ–ª–µ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö —á–∞—Å—Ç–µ–π:

- key ‚Äî –∫–æ–¥–∏—Ä—É–µ—Ç –Ω–æ–º–µ—Ä –ø–æ–ª—è (tag) –∏ wire type,
- value ‚Äî —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –¥–∞–Ω–Ω—ã–µ.

**–í—Å–µ–≥–æ 6 wire types:**

| Wire Type | –ù–æ–º–µ—Ä (3 –±–∏—Ç–∞) | –û–ø–∏—Å–∞–Ω–∏–µ                              | –ö–∞–∫–∏–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è                           |
| --------- | -------------- | ------------------------------------- | -------------------------------------------------------- |
| 0         | 0              | **Varint** (–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª–∏–Ω–∞ int)     | int32, int64, uint32, uint64, sint32, sint64, bool, enum |
| 1         | 1              | **64-–±–∏—Ç–Ω–æ–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ**           | fixed64, sfixed64, double                                |
| 2         | 2              | **Length-delimited** (–¥–ª–∏–Ω–∞ + –¥–∞–Ω–Ω—ã–µ) | string, bytes, embedded messages, packed repeated fields |
| 3         | 3              | **Start group** (—É—Å—Ç–∞—Ä–µ–≤—à–µ–µ)          | deprecated, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ proto3                     |
| 4         | 4              | **End group** (—É—Å—Ç–∞—Ä–µ–≤—à–µ–µ)            | deprecated, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ proto3                     |
| 5         | 5              | **32-–±–∏—Ç–Ω–æ–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ**           | fixed32, sfixed32, float                                 |


**–î–µ—Ç–∞–ª–∏:**

- **Wire type 0** ‚Äî **varint**:

    –ß–∏—Å–ª–∞ –∫–æ–¥–∏—Ä—É—é—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª–∏–Ω–æ–π ‚Äî –ø–æ 7 –±–∏—Ç –Ω–∞ –±–∞–π—Ç + 1 –±–∏—Ç –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è.
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª –∏ enum.

- **Wire type 1** ‚Äî **64-–±–∏—Ç–Ω–æ–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ**:

    –í—Å–µ–≥–¥–∞ 8 –±–∞–π—Ç –ø–æ–¥—Ä—è–¥. –î–ª—è `double`, `fixed64` –∏ `sfixed64`.

- **Wire type 2** ‚Äî **length-delimited**:
    
    –î–ª—è —Å—Ç—Ä–æ–∫, –±–∞–π—Ç–æ–≤—ã—Ö –º–∞—Å—Å–∏–≤–æ–≤ –∏ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.

- **Wire types 3 –∏ 4** ‚Äî –≥—Ä—É–ø–ø—ã:
    
    –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ, –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤ proto3.

- **Wire type 5** ‚Äî 32-–±–∏—Ç–Ω–æ–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ:
    
    –í—Å–µ–≥–¥–∞ 4 –±–∞–π—Ç–∞ –ø–æ–¥—Ä—è–¥. –î–ª—è `float`, `fixed64` –∏ `sfixed64`.

![alt text](image-1.png)

### Protocol buffers: encoding format

```proto
message Person {
    required string user_name = 1;
    optional int64 favorite_number = 2;
    repeated string interests = 3;
}
```

![alt text](image-3.png)

